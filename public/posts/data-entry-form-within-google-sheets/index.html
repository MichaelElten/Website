<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.68.3" />

    
    
    

<title>Data entry form within Google Sheets • Casual Inferences</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Data entry form within Google Sheets"/>
<meta name="twitter:description" content="A post to show how to make a data entry form within a Google Sheets workbook that can also work from the mobile App"/>

<meta property="og:title" content="Data entry form within Google Sheets" />
<meta property="og:description" content="A post to show how to make a data entry form within a Google Sheets workbook that can also work from the mobile App" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/data-entry-form-within-google-sheets/" />
<meta property="article:published_time" content="2020-05-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-18T12:28:16-04:00" /><meta property="og:site_name" content="Title" />


    








<link rel="stylesheet" href="/scss/hyde-hyde.1477b6491d9caa7632bca37c4e01b720435f018834b3835218360fc1bac79657.css" integrity="sha256-FHe2SR2cqnYyvKN8TgG3IENfAYg0s4NSGDYPwbrHllc=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="/">Casual Inferences</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="/img/Michael_BW.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         A WIP blog by ME 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Casual Inferences</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Portfolio</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/MichaelElten" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/MichaelElten" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/michael-elten-496115118/" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	<a href="mailto:elten.michael@gmail.com" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2019 - 2020 Michael Elten
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Data entry form within Google Sheets</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> May 25, 2020
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/methods">METHODS</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/google-sheets">google-sheets</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 4 min read
</div>


  </header>
  
  
  <div class="post">
    


<p><img src="/posts/data-entry-form-within-google-sheets/gif1_data_form_demo.gif" /></p>
<p>You may sometimes want to collect data directly in a Google Sheets form. While you can certainly do so manually in a giant data table, I find having a separate sheet for data entry may be a more elegant solution, and can also protect you from accidentally editing other rows in a data table.</p>
<p>Here I present a quick and easy way to design a data entry form within a Google Sheets workbook, that even works from the mobile app!</p>
<div id="setting-up" class="section level3">
<h3>Setting up</h3>
<p>You will want to have a <em>Form sheet</em> where the user enters data, a <em>Data sheet</em> where the submitted data gets compiled, and probably a third <em>Category sheet</em> that will hold the different options for some categories so that you can make some drop-down lists in the data entry form.</p>
</div>
<div id="form-sheet" class="section level3">
<h3>Form sheet</h3>
<p><img src="/posts/data-entry-form-within-google-sheets/pic1_formsheet.png" /></p>
<p>The form sheet should be a simple interface with the variables clearly labelled, and the data entry cells clearly indicated. Data validation should be used where possible to make data entry quicker and more accurate.</p>
</div>
<div id="data-sheet" class="section level3">
<h3>Data sheet</h3>
<p><img src="/posts/data-entry-form-within-google-sheets/pic2_datasheet.png" /></p>
<p>This sheet is where the data from the <em>Form sheet</em> will go into. The first row should be the same headers from the <em>form sheet</em>.</p>
</div>
<div id="categories-sheet" class="section level3">
<h3>Categories sheet</h3>
<p><img src="/posts/data-entry-form-within-google-sheets/pic3_categorysheet.png" /></p>
<p>This sheet contains the possible categories for some of the entries in the form sheet.</p>
</div>
<div id="google-scripts" class="section level3">
<h3>Google Scripts</h3>
<p>Here are two scripts that are used in this sheet:</p>
<pre><code>function SubmitData() {
  var ss        = SpreadsheetApp.getActiveSpreadsheet();
  var formSS    = ss.getSheetByName(&quot;Form sheet&quot;); 
  var datasheet = ss.getSheetByName(&quot;Data sheet&quot;);
  
  var values = [[formSS.getRange(&quot;A3&quot;).getValue(),
                 formSS.getRange(&quot;B3&quot;).getValue(),
                 formSS.getRange(&quot;C3&quot;).getValue(),
                 formSS.getRange(&quot;D3&quot;).getValue(),
                 formSS.getRange(&quot;E3&quot;).getValue()]];
  
  datasheet.getRange(datasheet.getLastRow()+1, 1, 1, 5).setValues(values);
  
  formSS.getRange(&#39;A3:E3&#39;).clearContent();

}

function ClearData() {
  var ss        = SpreadsheetApp.getActiveSpreadsheet();
  var formSS    = ss.getSheetByName(&quot;Form sheet&quot;);
  
  formSS.getRange(&#39;A3:E3&#39;).clearContent();

}</code></pre>
<p>The <code>SubmitData()</code> function takes the values in cells A3 to E3 of the forms sheet, and adds them as a new row at the bottom of the <em>Data sheet</em>, and then clears them from the data entry sheet.</p>
<p>The <code>ClearData()</code> function will clear the A3 to E3 cells in the form without adding them to the <em>Data sheet</em>.</p>
</div>
<div id="adding-a-button-to-launch-scripts" class="section level3">
<h3>Adding a button to launch scripts</h3>
<p>You can then assign these scripts to buttons so that they can be launched with a simple click.</p>
<p>First, create the drawing:</p>
<p><img src="/posts/data-entry-form-within-google-sheets/gif2_createbutton.gif" /></p>
<p>Next, assign the script:</p>
<p><img src="/posts/data-entry-form-within-google-sheets/gif3_assignscript.gif" /></p>
<p>Repeat the above for the ClearData script, and then you now can easily submit and clear data from the form with the click of a button.</p>
</div>
<div id="making-the-form-work-on-mobile" class="section level3">
<h3>Making the form work on mobile</h3>
<p>A drawback of the above way of launching Google Scripts is that it doesn’t work on the mobile app. If you want the ability to enter data from mobile, here is an easy way to accomplish that.</p>
<p>First, add a dropdown list somewhere on the <em>Form sheet</em> with the <code>SubmitData()</code> and <code>ClearData()</code> function names as options. Next, add the following script:</p>
<pre><code>function onEdit(e) {
var activesheet = SpreadsheetApp.getActiveSheet()  
  
if (activesheet.getName()==&#39;Form sheet&#39;){   
if (e.range.getA1Notation() == &#39;A5&#39;) {
    if (/^\w+$/.test(e.value)) {        
      this[e.value]();
      e.range.clearContent();
    }
  }
}
}</code></pre>
<p>I took this idea from <a href="https://webapps.stackexchange.com/questions/87346/add-a-script-trigger-to-google-sheet-that-will-work-in-android-mobile-app">this stack overflow thread</a>.</p>
<p>What this function does is it checks if the sheet is named <em>Form sheet</em>, and if the cell being edited is in <code>A5</code>. Then, if this cell contains a function name, it will run that function.</p>
<p>I named cell <code>A5</code> as this was where I placed the drop-down list in my sheet, but you should customize this script to specify the name of your sheet, and the location of the drop-down list in your sheet, of course.</p>
</div>
<div id="changing-the-number-of-fields-in-the-data-entry-form" class="section level3">
<h3>Changing the number of fields in the data entry form</h3>
<p>To change the number of fields in the data entry form is relatively easy - you just need to change several arguments in the Google Scripts.</p>
<p>In the <code>SubmitData()</code> function, you can change the number of values by adding or removing elements in the <code>var values</code> statement, changing the last number in the <code>datasheet.getRange()</code> statement from <code>5</code> to the number of elements you have in the form, and updating the range of cells to be cleared in the <code>formSS.getRange()</code> statement.</p>
<p>In the <code>ClearData()</code> function, just change the range in the <code>formSS.getRange()</code> statement to reflect the cells you want to be cleared.</p>
<p>Here is a handy picture of what should be changed in the Google scripts to make it fit your Google Sheet:
<img src="/posts/data-entry-form-within-google-sheets/pic4_ScriptCustomization.png" /></p>
<p>Finally, here is a link to a copy of the Google Sheet used in this demo: <a href="https://docs.google.com/spreadsheets/d/1cFy9au1BvoiQAo2KyXSJkFDdc2euRRDOctIygtCbdcU/edit?usp=sharing" class="uri">https://docs.google.com/spreadsheets/d/1cFy9au1BvoiQAo2KyXSJkFDdc2euRRDOctIygtCbdcU/edit?usp=sharing</a></p>
</div>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/subcategories-in-google-sheets/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Subcategories in Google Sheets</span>
    </a>
    
    
    <a href="/posts/getting-fitbit-data-in-r/" class="navigation-next">
      <span class="navigation-tittle">Getting-Fitbit-data-in-R</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-165914127-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>





    



    </body>
</html>
